<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SimpleDUTRemote: SimpleRemote Basic Tutorial</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SimpleDUTRemote
   </div>
   <div id="projectbrief">A simple automation solution</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">SimpleRemote Basic Tutorial </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This covers the basic usage of SimpleRemote, and is designed as a companion to the API documentation provided by doxygen.</p>
<p><em>A quick warning about security - this tool allows you to remotely control a device without any kind of authentication. You should only use this tool on secured networks.</em></p>
<h1><a class="anchor" id="autotoc_md6"></a>
Deploy the Server to your DUT</h1>
<p>The first step is to launch the SimpleRemote server on your DUT. Do to this, copy the compiled binaries for your platform to the device, and launch the <code>SimpleRemoteConsole.exe</code> binary.</p>
<p>Note that if need to call functions or system services that require administrator rights, you'll need to start the server as an administrator.</p>
<p>Note - the first time you run the tool, you'll likely get a prompt asking if you want to allow the tool through the firewall. If you don't, and you have issues connecting, either manually create a firewall exception on the device, or you can completely disable firewalls on the device by calling: </p><pre class="fragment">netsh advfirewall set allprofiles state off
</pre><p>If you only want to open specific ports of the firewall, see the <a href="#Firewall-Details">Firewall Details</a> section, located toward the end of this document.</p>
<h1><a class="anchor" id="autotoc_md7"></a>
Using the .NET Client</h1>
<p>The easiest way to use the server is to use the .NET Client library, which is <a class="el" href="class_simple_d_u_t_client_library_1_1_rpc_client.html">documented here</a>. As a demonstration, we'll use the client in PowerShell to show how easy it is.</p>
<p><em>Warning for Nuget users: SimpleRemote's nuget packages require the PackageReference format, and will not work correctly if you're using the packages.config format (the default method for managing packges for .NET Framework projects). Please review the <a href="https://blog.nuget.org/20170316/NuGet-now-fully-integrated-into-MSBuild.html">article here</a> for information on how to switch a project to use PackageReference format (see the section under 'What about other project types that are not .NET Core?').</em></p>
<p>Before we begin, we'll need to give PowerShell information about our RpcClient class. To do that, navigate to the directory containing the SimpleDUTClientLibrary DLL, and open a PowerShell instance. Then call: </p><pre class="fragment">Add-Type -Path SimpleDUTClientLibrary.dll
</pre><p>Once you've done that, you can create a client instance by calling: </p><pre class="fragment">$client = new-object SimpleDUTClientLibrary.RpcClient -argumentlist "127.0.0.1",8000
</pre><p>In your case, you should replace "127.0.0.1" with the IP address if your device, and 8000 with your server's port number (it defaults to 8000, but can be changed with command line arguments).</p>
<p>Note that simply creating a client object doesn't generate a connection. To do that, we'll need to run a method. To see the available methods on the client DLL, you can call: </p><pre class="fragment">$client | Get-Member
</pre><p>So, to launch notepad on the remote machine, and return immediately, you would call: </p><pre class="fragment">$client.Run("notepad.exe")
</pre><p>To run a command and get output, you would use the <a class="el" href="class_simple_d_u_t_client_library_1_1_rpc_client.html#ac31c5dbaac59e3be5d283ca0bf2d728b">RunJob</a> function: </p><pre class="fragment">$client.RunJob("systeminfo.exe")
</pre><p>Note that any returned standard out/standard error will have new line characters at the end of the returned string, as it would on the remote machine (this is something to be aware of if you plan on comparing the output to a known value).</p>
<h1><a class="anchor" id="autotoc_md8"></a>
Getting More Information on the Server</h1>
<p>The server uses NLog to provide information back to the user. By default, the logger will only write messages to the terminal, and only show messages at level <code>Info</code> or higher. If you want to see more detailed information about what the server is doing, you can set the <code>minlevel</code> option in the <code>Nlog.conf</code> file (it's in the same folder as <code>SimpleRemoteConsole.exe</code>) to <code>Debug</code>. You may want to do this if you want to see the stdout and stderr of a called processes as it is generated.</p>
<p>Nlog can also be configured to write to files, the Windows event log, and a number of other locations. To see more information on how to configure logging, see the <a href="https://github.com/NLog/NLog/wiki/Tutorial#configuration">NLog Tutorial</a>.</p>
<h1><a class="anchor" id="autotoc_md9"></a>
Running as a Service</h1>
<p>You can install SimpleRemote as a service on any Windows system. Simple launch the <a class="el" href="namespace_simple_remote_console.html">SimpleRemoteConsole</a> exe from an elevated command prompt, and include the arg <code>--install-service</code>, as well as any other flags you wish to use (such as specifying the port). By default, the service will not start automatically, unless you specify <code>--service-start-type auto</code> when installing the service.</p>
<p>The service can be removed from the system my running <code>--uninstall-service</code> from an elevated command prompt.</p>
<p>While running with a service is useful for some applications, note that the service will not be attached to a specific user session. As such, automating graphical applications may not work as expected.</p>
<h1><a class="anchor" id="autotoc_md10"></a>
Firewall Details</h1>
<p>In some cases, you may only want to open specific ports on the DUT instead of turning off the firewall completely. If this the case, you'll need to open:</p>
<ul>
<li>The simple remote communication port (TCP 8000 by default)</li>
<li>TCP port(s) for upload/download operations</li>
<li>Optional: The UDP broadcast port (UDP 8001 by default)</li>
</ul>
<p>By defult, when an upload or download is started, the system running SimpleRemote will choose a random port for the transfer. However, this can be undesirable if you want to limit SimpleRemote to certain ports. To control which port is used for an upload or download, specify a port argument to the Upload or Download function.</p>
<p><em>Note: Each transfer uses its own socket on the server machine. Do not attempt to do multiple transfers on the same port at the same time.</em> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.18
</small></address>
</body>
</html>
